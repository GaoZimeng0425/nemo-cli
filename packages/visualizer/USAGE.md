# ND AI ä¾èµ–å…³ç³»å¯è§†åŒ–å·¥å…· - ä½¿ç”¨æŒ‡å—

## å¿«é€Ÿå¼€å§‹

### 1. ç”Ÿæˆä¾èµ–æ•°æ®

åœ¨ä½ çš„ **Next.js é¡¹ç›®**ç›®å½•ä¸‹è¿è¡Œ:

```bash
nd analyze --format ai
```

è¿™å°†åœ¨ `ai-docs/` ç›®å½•ä¸‹ç”Ÿæˆ `deps.ai.json` æ–‡ä»¶ã€‚

### 2. å¯åŠ¨å¯è§†åŒ–å·¥å…·

æœ‰ä¸¤ç§æ–¹å¼å¯åŠ¨:

#### æ–¹å¼ä¸€: é€šè¿‡ CLI å‘½ä»¤ (æ¨è)

```bash
nd visualize --open
```

é€‰é¡¹è¯´æ˜:
- `--open`: è‡ªåŠ¨æ‰“å¼€æµè§ˆå™¨
- `-p, --port <number>`: æŒ‡å®šç«¯å£ (é»˜è®¤ 3000)

#### æ–¹å¼äºŒ: ç›´æ¥å¯åŠ¨å¼€å‘æœåŠ¡å™¨

```bash
cd packages/visualizer
pnpm run dev
```

### 3. åŠ è½½ä¾èµ–æ–‡ä»¶

æ‰“å¼€æµè§ˆå™¨è®¿é—® `http://localhost:3000`ï¼Œç„¶å:

- **æ‹–æ‹½æ–¹å¼**: å°† `deps.ai.json` æ–‡ä»¶æ‹–æ‹½åˆ°é¡µé¢ä¸Š
- **ç‚¹å‡»é€‰æ‹©**: ç‚¹å‡»æ–‡ä»¶é€‰æ‹©åŒºåŸŸï¼Œé€‰æ‹© `deps.ai.json` æ–‡ä»¶

## åŠŸèƒ½è¯´æ˜

### ğŸ¨ äº¤äº’æ“ä½œ

| æ“ä½œ | åŠŸèƒ½ |
|------|------|
| **æ‹–æ‹½ç”»å¸ƒ** | å¹³ç§»è§†å›¾ |
| **é¼ æ ‡æ»šè½®** | ç¼©æ”¾è§†å›¾ |
| **æ‹–æ‹½èŠ‚ç‚¹** | ç§»åŠ¨èŠ‚ç‚¹ä½ç½® |
| **å•å‡»èŠ‚ç‚¹** | æŸ¥çœ‹èŠ‚ç‚¹è¯¦æƒ… |
| **åŒå‡»èŠ‚ç‚¹** | åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€æ–‡ä»¶ (å¼€å‘ä¸­) |
| **ç‚¹å‡»ç©ºç™½å¤„** | å–æ¶ˆé€‰æ‹© |

### ğŸ” ç­›é€‰å’Œæœç´¢

#### 1. Scope è¿‡æ»¤å™¨

ç‚¹å‡»é¡¶éƒ¨çš„ scope æŒ‰é’®æ¥è¿‡æ»¤èŠ‚ç‚¹:
- **App**: åº”ç”¨ä»£ç  (è“è‰²)
- **Workspace**: workspace åŒ… (ç»¿è‰²)
- **External**: å¤–éƒ¨ä¾èµ– (ç°è‰²)
- **Internal**: å†…éƒ¨ä¾èµ– (æ©™è‰²)
- **Other**: å…¶ä»– (ç´«è‰²)

#### 2. è§†å›¾æ¨¡å¼

- **å…¨éƒ¨**: æ˜¾ç¤ºæ‰€æœ‰èŠ‚ç‚¹
- **é¡µé¢**: åªæ˜¾ç¤ºç‰¹å®šé¡µé¢åŠå…¶ä¾èµ–
- **å¾ªç¯**: åªæ˜¾ç¤ºå¾ªç¯ä¾èµ– (SCC) èŠ‚ç‚¹

#### 3. é¡µé¢é€‰æ‹©

å½“é€‰æ‹©"é¡µé¢"è§†å›¾æ¨¡å¼æ—¶,å¯ä»¥ä»ä¸‹æ‹‰èœå•é€‰æ‹©ç‰¹å®šè·¯ç”±é¡µé¢ã€‚

#### 4. æœç´¢æ¡†

åœ¨æœç´¢æ¡†ä¸­è¾“å…¥æ–‡ä»¶åå…³é”®è¯,åŒ¹é…çš„èŠ‚ç‚¹ä¼šé«˜äº®æ˜¾ç¤ºã€‚

### ğŸ“Š èŠ‚ç‚¹ä¿¡æ¯

#### èŠ‚ç‚¹æ ·å¼è¯´æ˜

| è§†è§‰å…ƒç´  | å«ä¹‰ |
|---------|------|
| **èŠ‚ç‚¹é¢œè‰²** | è¡¨ç¤º scope (åº”ç”¨/workspace/å¤–éƒ¨) |
| **è¾¹æ¡†æ ·å¼** | è¡¨ç¤ºèŠ‚ç‚¹ç±»å‹ (page/layout/component/util) |
| **çº¢è‰²è„‰å†²ç‚¹** | è¡¨ç¤ºè¯¥èŠ‚ç‚¹åœ¨å¾ªç¯ä¾èµ–ä¸­ |
| **å¾½ç« æ•°å­—** | å·¦ä¾§ç®­å¤´æ•°å­—=ä¾èµ–æ•°, å³ä¾§ç®­å¤´æ•°å­—=è¢«ä¾èµ–æ•° |
| **ç´«è‰² dyn æ ‡ç­¾** | è¡¨ç¤ºåŠ¨æ€å¯¼å…¥ |

#### è¯¦æƒ…é¢æ¿

ç‚¹å‡»èŠ‚ç‚¹å,å³ä¾§é¢æ¿ä¼šæ˜¾ç¤º:
- ğŸ“ æ–‡ä»¶è·¯å¾„ (ç»å¯¹è·¯å¾„å’Œç›¸å¯¹è·¯å¾„)
- ğŸ“Š ç»Ÿè®¡ä¿¡æ¯ (ä¾èµ–æ•°ã€è¢«ä¾èµ–æ•°)
- ğŸ“¦ åŒ…ä¿¡æ¯ (package nameã€workspace package)
- ğŸ”— ä¾èµ–åˆ—è¡¨ (è¯¥èŠ‚ç‚¹ä¾èµ–çš„æ‰€æœ‰æ–‡ä»¶)
- ğŸ”™ è¢«ä¾èµ–åˆ—è¡¨ (ä¾èµ–è¯¥èŠ‚ç‚¹çš„æ‰€æœ‰æ–‡ä»¶)
- ğŸ” å¾ªç¯ä¾èµ–ä¿¡æ¯ (å¦‚æœåœ¨ SCC ä¸­)
- ğŸ“„ æ‰€å±é¡µé¢åˆ—è¡¨

### âŒ¨ï¸ é”®ç›˜å¿«æ·é”®

| å¿«æ·é”® | åŠŸèƒ½ |
|--------|------|
| `Ctrl/Cmd + F` | èšç„¦åˆ°æœç´¢æ¡† |
| `ESC` | æ¸…é™¤æœç´¢ / å–æ¶ˆé€‰æ‹© |
| `+` / `-` | æ”¾å¤§ / ç¼©å° |
| `0` | é‡ç½®ç¼©æ”¾ |

## ä½¿ç”¨ç¤ºä¾‹

### åœºæ™¯ 1: åˆ†æé¡µé¢ä¾èµ–

1. è¿è¡Œ `nd analyze --format ai`
2. è¿è¡Œ `nd visualize --open`
3. åŠ è½½ç”Ÿæˆçš„æ–‡ä»¶
4. åœ¨"è§†å›¾"ä¸­é€‰æ‹©"é¡µé¢"
5. ä»ä¸‹æ‹‰èœå•é€‰æ‹©ç‰¹å®šé¡µé¢ (å¦‚ `/dashboard`)
6. æŸ¥çœ‹è¯¥é¡µé¢çš„æ‰€æœ‰ç»„ä»¶ä¾èµ–

### åœºæ™¯ 2: æŸ¥æ‰¾å¾ªç¯ä¾èµ–

1. åŠ è½½ä¾èµ–æ–‡ä»¶
2. åœ¨"è§†å›¾"ä¸­é€‰æ‹©"å¾ªç¯"
3. æ‰€æœ‰å¾ªç¯ä¾èµ–èŠ‚ç‚¹ä¼šæ˜¾ç¤ºçº¢è‰²è„‰å†²åŠ¨ç”»
4. ç‚¹å‡»ä»»æ„èŠ‚ç‚¹æŸ¥çœ‹è¯¦æƒ…é¢æ¿ä¸­çš„ SCC ç»„ä¿¡æ¯

### åœºæ™¯ 3: æœç´¢ç‰¹å®šç»„ä»¶

1. åŠ è½½ä¾èµ–æ–‡ä»¶
2. åœ¨æœç´¢æ¡†è¾“å…¥ç»„ä»¶å (å¦‚ `Button`)
3. åŒ¹é…çš„èŠ‚ç‚¹ä¼šé«˜äº®æ˜¾ç¤º
4. ç‚¹å‡»æŸ¥çœ‹è¯¦æƒ…

### åœºæ™¯ 4: åˆ†æå¤–éƒ¨ä¾èµ–

1. åŠ è½½ä¾èµ–æ–‡ä»¶
2. åªå‹¾é€‰ "External" scope
3. æŸ¥çœ‹æ‰€æœ‰å¤–éƒ¨ä¾èµ–å…³ç³»

## æ–‡ä»¶æ ¼å¼è¯´æ˜

`deps.ai.json` æ–‡ä»¶ç»“æ„:

```json
{
  "meta": {
    "generatedAt": "2025-01-01T00:00:00.000Z",
    "appRoot": "/path/to/app",
    "appDir": "/path/to/app/app"
  },
  "nodes": {
    "app/page.tsx": {
      "id": "app/page.tsx",
      "path": "/absolute/path",
      "relativePath": "app/page.tsx",
      "scope": "app",
      "moduleSystem": "es6",
      "dynamic": false,
      "type": "page",
      "dependencies": ["components/Button.tsx"],
      "dependents": []
    }
  },
  "pages": {
    "/": {
      "route": "/",
      "routeType": "page",
      "entryFile": "app/page.tsx",
      "layoutChain": [],
      "nodeIds": ["app/page.tsx"]
    }
  },
  "sccs": [
    {
      "id": "scc-1",
      "nodes": ["compA.tsx", "compB.tsx"]
    }
  ],
  "nodeToScc": {
    "compA.tsx": "scc-1",
    "compB.tsx": "scc-1"
  }
}
```

## æ•…éšœæ’é™¤

### é—®é¢˜: "Cannot resolve @nemo-cli/deps"

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ç¡®ä¿åœ¨ workspace æ ¹ç›®å½•è¿è¡Œ
cd /path/to/nemo-cli
pnpm install
```

### é—®é¢˜: "ç«¯å£è¢«å ç”¨"

**è§£å†³æ–¹æ¡ˆ**:
```bash
# ä½¿ç”¨å…¶ä»–ç«¯å£
nd visualize --port 3001
```

### é—®é¢˜: "æ‰¾ä¸åˆ° deps.ai.json"

**è§£å†³æ–¹æ¡ˆ**:
1. ç¡®ä¿åœ¨ Next.js é¡¹ç›®ç›®å½•ä¸‹è¿è¡Œ `nd analyze --format ai`
2. æ£€æŸ¥æ–‡ä»¶æ˜¯å¦åœ¨ `ai-docs/deps.ai.json`
3. å°è¯•é‡æ–°ç”Ÿæˆ: `rm -rf ai-docs && nd analyze --format ai`

### é—®é¢˜: å›¾è¡¨åŠ è½½ç¼“æ…¢

**è§£å†³æ–¹æ¡ˆ**:
1. å¯¹äºè¶…å¤§å‹é¡¹ç›® (>5000 èŠ‚ç‚¹),ä½¿ç”¨ scope è¿‡æ»¤å™¨å‡å°‘èŠ‚ç‚¹
2. ä½¿ç”¨"é¡µé¢"è§†å›¾æ¨¡å¼åªæŸ¥çœ‹ç‰¹å®šé¡µé¢
3. å…³é—­æµè§ˆå™¨å…¶ä»–æ ‡ç­¾é¡µé‡Šæ”¾å†…å­˜

### é—®é¢˜: æ— æ³•æ‰“å¼€æ–‡ä»¶

**åŸå› **: VS Code åè®®å¯èƒ½è¢«æ‹¦æˆªæˆ–æœªå®‰è£… VS Code

**è§£å†³æ–¹æ¡ˆ**: æ–‡ä»¶è·¯å¾„ä¼šè‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿,æ‰‹åŠ¨åœ¨ç¼–è¾‘å™¨ä¸­æ‰“å¼€

## æ€§èƒ½å‚è€ƒ

| é¡¹ç›®è§„æ¨¡ | èŠ‚ç‚¹æ•° | åŠ è½½æ—¶é—´ | æ¨èæ“ä½œ |
|---------|-------|---------|---------|
| å°å‹ | <100 | <1ç§’ | æŸ¥çœ‹å…¨å›¾ |
| ä¸­å‹ | 100-1000 | 1-3ç§’ | ä½¿ç”¨è¿‡æ»¤å™¨ |
| å¤§å‹ | 1000-5000 | 3-5ç§’ | åˆ†é¡µæŸ¥çœ‹ |
| è¶…å¤§å‹ | >5000 | 5+ç§’ | ä½¿ç”¨èšåˆæ¨¡å¼ (å¼€å‘ä¸­) |

## é«˜çº§ç”¨æ³•

### è‡ªå®šä¹‰ Vite é…ç½®

ç¼–è¾‘ `packages/visualizer/vite.config.ts`:

```typescript
export default defineConfig({
  server: {
    port: 3000,
    open: false,
    cors: true,
  },
  // ... å…¶ä»–é…ç½®
})
```

### ç¯å¢ƒå˜é‡

åˆ›å»º `.env` æ–‡ä»¶:

```bash
VITE_PORT=3000
VITE_OPEN=true
VITE_DEBUG_PERFORMANCE=false
```

### æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
cd packages/visualizer
pnpm run build
pnpm run preview
```

## ç›¸å…³å‘½ä»¤

```bash
# ç”Ÿæˆä¾èµ–æ•°æ®
nd analyze --format ai

# å¯åŠ¨å¯è§†åŒ–å·¥å…·
nd visualize --open

# æŒ‡å®šç«¯å£
nd visualize --port 8080

# æŸ¥çœ‹å¸®åŠ©
nd visualize --help
```

## åé¦ˆå’Œé—®é¢˜

å¦‚æœ‰é—®é¢˜æˆ–å»ºè®®,è¯·è®¿é—®:
- GitHub Issues: https://github.com/GaoZimeng0425/nemo-cli/issues
- é¡¹ç›®æ–‡æ¡£: `packages/visualizer/README.md`
